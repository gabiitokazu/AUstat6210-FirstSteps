---
title: "HW1_exer2"
author: "Group9"
date: "9/4/2020"
output: html_document
---

# Exercise 2: Financial Analysis

```{r trueinstall, echo=FALSE, message=FALSE, warning=FALSE}

if (!require("quantmod")) {
    install.packages("quantmod")
    library(quantmod)
}

```

The data set from four companies was obtained from yahoo, from January 1-2019 to September 6-2020. This was done utilizing the package `quantmod`:

```{r install, results=FALSE, message=FALSE, warning=FALSE}

start <- as.Date("2019-01-01")
end <- as.Date(Sys.Date())

getSymbols("VALE", src="yahoo", from=start, to=end)
getSymbols("CSCO", src="yahoo", from=start, to=end)
getSymbols("INTC", src="yahoo", from=start, to=end)
getSymbols("WFC", src="yahoo", from=start, to=end)

```
\

After that, all the data sets should be fetched and can be seen in the environment tab. We can take a look at them here using the command `head(dataset)`. For the VALE dataset, for example:

```{r viewdata, include=TRUE, eval=TRUE, echo=FALSE}

head(VALE)

```
\

An xts object `stocks` was created to unify all closing values from all the datasets, and then used to plot these values:

```{r stocks_object, include=TRUE, eval=TRUE}

stocks <- as.xts(data.frame(VALE=VALE[, "VALE.Close"],
                            CSCO=CSCO[, "CSCO.Close"],
                            INTC=INTC[, "INTC.Close"],
                            WFC=WFC[, "WFC.Close"]
                            ))
```

```{r plot_, echo=TRUE, results=FALSE, fig.show='hide', message=FALSE, warning=FALSE}

plot(as.xts(stocks),
     screens=1,
     lty=1:4,
     xlab="Date",
     ylab="Price",
     font.axis=1)
```

```{r plot, fig.align="center", fig.width=8, fig.cap="Figure 1. Chart of the closing price of the four stocks over the period of January 01, 2019 to September 06, 2020.", include=TRUE, eval=TRUE}

addLegend(legend.loc = "topleft",
          legend.names = c("Vale S.A.", "Cisco", "Intel", "Wells Fargo"),
          lty= 1:4,
          col = NULL,
          ncol = 1,
          cex = 0.8,
          on = 1)
```
\

Using the command `candleChart(dataset)` and specifying the date ranges, we can create a candlestick chart to view the price movements of these four stocks for each day of the past four months. Each day is represented by a "candle" which appears to be similar to a box plot, but the anatomy of a candle is slightly different.

**Wicks:** First, the lines or "wicks" sticking out of the top and bottom represent the high and low price of the stock. The top wick represents the highest price reached for the day while the bottom wick represents the lowest price reached.

**Color:** The color of the box represents if the price increased or decreased from the beginning to the end of the day. <font color="gray">Gray</font> boxes represent an overall increase for the day while <font color="blue">blue</font> boxes represent a decrease.

**Boxes:** Depending on the color, the top and bottom of the box (excluding the wick) changes meaning. If the box is <font color="gray">gray</font> representing an increase, then the bottom of the box is the opening price of the stock and the top of the box is the closing price. If the box is <font color="blue">blue</font> representing an overall decrease, then the top of the box is the closing price while the bottom is the opening price.

```{r candlechart, fig.align="center", fig.width=8, fig.cap="Figure 2. Candlestick chart of the four stocks over the past four months.", include=TRUE, eval=TRUE}

FinancialAnalysis <- as.xts(data.frame(VALE=VALE['2020-05-01/2020-09-06'],
                                       CSCO=CSCO['2020-05-01/2020-09-06'],
                                       INTC=INTC['2020-05-01/2020-09-06'],
                                       WFC=WFC['2020-05-01/2020-09-06']
                                       ))
candleChart(FinancialAnalysis,
            up.col="gray",
            dn.col="blue",
            theme="white")


```
\

Other than using visuals, we can get an idea of the average price and fluctuation in price of these stocks from this time series by simply computing their means and variances. Again, using the last four months, the means of the four chosen stocks are listed below. From these means we can see Vale S.A. has a much lower average price over the past four months when compared to the other three, and Intel Corporation has the highest average stock price.

```{r mean, include=TRUE, eval=TRUE, echo=FALSE}

subset <-  as.xts(data.frame(VALE=VALE[, "VALE.Close"], CSCO=CSCO[, "CSCO.Close"], INTC=INTC[, "INTC.Close"], WFC=WFC[, "WFC.Close"]))

lapply(subset, mean)

```
\

The mean stock price doesn't tell the whole story, however. It is a good idea to calculate the variance which indicates how spread out the data are from the mean. A higher stock price variance indicates a higher volatility in the past four months. The variances of each stock are calculated below. From them we can see that although Vale S.A. had the lowest average stock price over the past four months, it also has the lowest variance, indicating that it stayed the most consistent. Wells Fargo, on the other hand, had the largest variance by a large margin, indicating that its stock price was the most volatile out of the four.

```{r var, include=TRUE, eval=TRUE, echo=FALSE}

subset <-  as.xts(data.frame(VALE=VALE[, "VALE.Close"], CSCO=CSCO[, "CSCO.Close"], INTC=INTC[, "INTC.Close"], WFC=WFC[, "WFC.Close"]))

lapply(subset, var)

```

### 6
### 7 
